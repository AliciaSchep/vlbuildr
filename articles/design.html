<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Design • vlbuildr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Design">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vlbuildr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/design.html">Design</a>
    </li>
    <li>
      <a href="../articles/examples.html">Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Design</h1>
                        <h4 class="author">Alicia Schep</h4>
            
            <h4 class="date">2020-01-06</h4>
      
      
      <div class="hidden name"><code>design.Rmd</code></div>

    </div>

    
    
<div id="a-functional-approach-to-buidling-up-specs" class="section level1">
<h1 class="hasAnchor">
<a href="#a-functional-approach-to-buidling-up-specs" class="anchor"></a>A functional approach to buidling up specs</h1>
<p>This package seeks to build up a library of functions that can iteratively build up a Vega-Lite spec. There is an initializer function <code>vl_chart</code> that initializes the chart (and can optionally take in values for top-level spec attributes), and then subsequent functions can add various component to a spec – they take in a spec as input as well as arguments relating to the new component and return a modified spec with the new component.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(vlbuildr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="../reference/vl_chart.html">vl_chart</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">   </span><span class="kw"><a href="../reference/vl_add_data.html">vl_add_data</a></span>(<span class="dt">values =</span> mtcars) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">   </span><span class="kw"><a href="../reference/vl_mark_point.html">vl_mark_point</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="st">   </span><span class="kw"><a href="../reference/vl_encode_x.html">vl_encode_x</a></span>(<span class="st">"wt"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="st">   </span><span class="kw"><a href="../reference/vl_encode_y.html">vl_encode_y</a></span>(<span class="st">"mpg"</span>)</a></code></pre></div>
<div id="underlying-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#underlying-objects" class="anchor"></a>Underlying objects</h2>
<p>At the moment, the various top-level specs are S3 classes that are basically treated as lists. A few of the internal functions take advantage of the classes to help determine the right way to add a component.</p>
<p>There currently are no classes for any sub-components of a spec, e.g. a class that might correspond to an “Axis” definition from the Vega-Lite spec. Rather, functions build those components as lists, and the validity is checked using the schema.</p>
<p>Moving to an approach where actual classes are defined for each potential object is a possibility. The motivation for such an approach would be cleaner internal handing rather than a substantially different API, as this package would seek to primarily present to users a functional interface for building up specs. The user-facing aspect that would be most likely to change would be:</p>
<div id="making-sub-components" class="section level3">
<h3 class="hasAnchor">
<a href="#making-sub-components" class="anchor"></a>Making sub-components</h3>
<p>The package currently offer a number of functions prefixed with <code>vl_make_</code> such as <code>vl_make_BinParams</code> which make a given sub-component of a Vega-Lite spec (what could map to an object if taking a more Object-oriented approach). These functions are intended to build sub-components that can be passed as arguments to functions that add to a spec.</p>
<p>However, the intention is to make the functions that add to a spec granular enough that in general most won’t need complicated nested objects to be taken in as arguments, so that in most cases these <code>vl_make_</code> functions won’t be needed.</p>
<p>This part of the API might change, especially if the internal components are reworked to make use of objects corresponding to these sub-components.</p>
</div>
</div>
<div id="correctness-of-specs-being-built" class="section level2">
<h2 class="hasAnchor">
<a href="#correctness-of-specs-being-built" class="anchor"></a>Correctness of specs being built</h2>
<p>This package may build incorrect specs if given improper inputs or if not all needed components are added to a spec. Some protection against this has been added by adding sub-schema validation. When a function adds a component to a spec, it checks that the component is correct. However, it may be possible to add invalid combinations of individual components to a spec.</p>
<p>Potentially validation could also occur prior to printing (to check the validity of the entire spec), but that might be something to add to the vegawdiget package, which handles the printing.</p>
</div>
</div>
<div id="construction-of-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#construction-of-the-package" class="anchor"></a>Construction of the package</h1>
<div id="a-semi-automated-approach-to-building-an-api" class="section level2">
<h2 class="hasAnchor">
<a href="#a-semi-automated-approach-to-building-an-api" class="anchor"></a>A semi-automated approach to building an API</h2>
<p>The functions in this package are build up using a semi-automated approach. A companion package <a href="https://github.com/AliciaSchep/vlmetabuildr">vlmetabuildr</a> is used to write the functions in the ‘zzz_autogen_api.R’ file.</p>
<p>Note that this process is very much <strong>semi</strong>-automated and not fully automated. vlmetabuildr has been made specific for the Vega-lite api and this package and is not a general purpose JSON Schema –&gt; API package.</p>
<p>Specific patterns for building up an API (e.g. groups of functions) are identified, such as adding an encoding via <code>vl_encode_&lt;channel&gt;</code> functions for each channel. A function for adding an encoding to a spec generally is hand-crafted and built within this package. The vlmetabuildr package will then make functions for (1) identifying all channels that need such a function, and (2) building up a function for each channel that has the appropriate arguments and documentations pulled from the Vega-lite schema.</p>
<p>In summary, what <strong>is not</strong> automated includes:</p>
<ul>
<li>Identifying what general groups of functions needed for adding to a spec</li>
<li>Mapping types of functions with where in the schema to pull the reqiurements</li>
<li>The internal functions for adding a category of components to a spec</li>
</ul>
<p>What <strong>is</strong> automated includes:</p>
<ul>
<li>Figuring out all the varieties of a group of functions, e.g. what all the channels are that should get an encode function</li>
<li>Adding the right parameters to a function based on the requirements in the schema</li>
<li>Adding documentation for parameters based on descriptions from the schema</li>
</ul>
<p>The parts that are automated would be extremely tedious to do manually. Potentially more of the API construction could be automated, however, the difficulty of the automation would increase substantially and/or the resulting API might be clunkier.</p>
</div>
<div id="details" class="section level2">
<h2 class="hasAnchor">
<a href="#details" class="anchor"></a>Details</h2>
<div id="build-the-auto-generated-components" class="section level3">
<h3 class="hasAnchor">
<a href="#build-the-auto-generated-components" class="anchor"></a>Build the auto-generated components</h3>
<p>There is a script ‘build/build.R’ that builds the auto-generated components of the package.</p>
</div>
<div id="stucture-of-adder-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#stucture-of-adder-functions" class="anchor"></a>Stucture of ‘adder’ functions</h3>
<p>Most of the auto-generated functions will call an internal function to add the specified component to the spec. Those functions generally take as argument at least three arguments: (1) the old spec, (2) the new object to add (a list), (3) a reference within the schema of what the object corresponds to. Additionally, more arguments needed to specify how the component should get added might also be included. The adder function will generally validate the object.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#a-functional-approach-to-buidling-up-specs">A functional approach to buidling up specs</a><ul class="nav nav-pills nav-stacked">
<li><a href="#underlying-objects">Underlying objects</a></li>
      <li><a href="#correctness-of-specs-being-built">Correctness of specs being built</a></li>
      </ul>
</li>
      <li>
<a href="#construction-of-the-package">Construction of the package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#a-semi-automated-approach-to-building-an-api">A semi-automated approach to building an API</a></li>
      <li><a href="#details">Details</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Aicia Schep.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
